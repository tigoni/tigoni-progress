---
import { buttonVariants, capitalizeFirstLetter } from "@/lib/utils";
import Layout from "./layout.astro";
import { ArrowLeft } from "lucide-react";
import Navbar from "@/components/navbar/index.astro";
import Footer from "@/components/footer.astro";
import Github from "@/components/ui/icons/github.astro";

import { ExternalLink } from "lucide-react";

import Pattern from "@/components/ui/pattern.astro";

import Box from "@/components/box/index.astro";
import BoxTitle from "@/components/box/title.astro";
import BoxHeader from "@/components/box/header.astro";
import BoxContent from "@/components/box/content.astro";

import LinkBtn from "@/components/ui/link-btn.astro";
import Badge from "@/components/ui/badge.astro";

interface Props {
  title: string;
  technologies: string[];
  sourceCode?: string;
  preview?: string;
  image?: string;
  description: string;
}

const { title, technologies, description, preview, sourceCode, image } =
  Astro.props;
---

<Layout title={`${title}`} ogImage={image} description={description}>
  <Navbar className="top-1" />

  <main aria-label="Main content" class="min-h-screen">
    <div class="mx-auto max-w-3xl">
      <Pattern className="h-14">
        <div class="absolute inset-x-0 bottom-0 z-1 px-2 flex items-center justify-between">
          <LinkBtn ariaLabel="Back btn" href="/projects">
            <ArrowLeft className="size-4" />
          </LinkBtn>
          
          <div class="flex gap-2 pb-1">
            {sourceCode && (
              <a 
                href={sourceCode} 
                target="_blank"
                class="inline-flex items-center gap-2 rounded-full border border-border/40 bg-background/50 px-3 py-1 text-[10px] font-bold uppercase tracking-widest text-muted-foreground/80 transition-all hover:bg-primary hover:text-primary-foreground hover:border-primary"
              >
                Source <Github className="size-3" />
              </a>
            )}
            {preview && (
              <a 
                href={preview} 
                target="_blank"
                class="inline-flex items-center gap-2 rounded-full border border-border/40 bg-background/50 px-3 py-1 text-[10px] font-bold uppercase tracking-widest text-muted-foreground/80 transition-all hover:bg-primary hover:text-primary-foreground hover:border-primary"
              >
                Preview <ExternalLink className="size-3" />
              </a>
            )}
          </div>
        </div>
      </Pattern>

      <Box>
        <BoxHeader class="px-8 pt-10 pb-4">
          <div class="flex flex-wrap gap-2 mb-6">
            {technologies.map(tech => (
              <span class="rounded-full border border-primary/10 bg-primary/5 px-2.5 py-0.5 text-[9px] font-bold uppercase tracking-widest text-primary/70">
                {tech}
              </span>
            ))}
          </div>
          <BoxTitle className="text-4xl font-black leading-[1.1] tracking-tighter md:text-5xl">
            {capitalizeFirstLetter(title)}
          </BoxTitle>
          <p class="mt-6 text-lg text-muted-foreground/80 leading-relaxed italic">
            {description}
          </p>
        </BoxHeader>

        <Pattern />
      </Box>

      <Box className="min-w-full">
        <BoxContent className="px-8 pt-12 pb-24">
          <article class="prose prose-neutral dark:prose-invert max-w-none prose-headings:font-black prose-headings:tracking-tighter prose-h2:text-3xl prose-a:text-primary prose-a:no-underline hover:prose-a:underline prose-pre:rounded-2xl prose-pre:border prose-pre:border-border/50 prose-img:rounded-2xl prose-img:shadow-xl">
            <slot />
          </article>
        </BoxContent>
      </Box>
    </div>
  </main>

  <Footer />
</Layout>
